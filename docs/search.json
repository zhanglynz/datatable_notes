[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Learning data.table Notes",
    "section": "",
    "text": "Preface\nMy notes on learning data.table.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#basics",
    "href": "index.html#basics",
    "title": "Learning data.table Notes",
    "section": "Basics",
    "text": "Basics\n\ndata.table()\n\n\nlibrary(data.table)\nsmall_dtb &lt;- data.table(x = letters[1:5],\n                        y = rnorm(5),\n                        z = 1:5)\nsmall_dtb\n\n        x          y     z\n   &lt;char&gt;      &lt;num&gt; &lt;int&gt;\n1:      a  0.7483929     1\n2:      b  0.4520126     2\n3:      c  1.2175161     3\n4:      d  1.4380206     4\n5:      e -0.3924529     5\n\n\n\nYou can also convert existing objects to a data.table using setDT() (for data.frame and list structures) or as.data.table() (for other structures).\n\n\ngeneral form DT[i, j, by] — Take DT, subset/reorder rows using i, then calculate j, grouped by by.\nsubset rows in i\n\nExample:\n\n(small_dtb[x %in% c('a', 'b', 'c', 'e') & z &gt;= 3])\n\n        x          y     z\n   &lt;char&gt;      &lt;num&gt; &lt;int&gt;\n1:      c  1.2175161     3\n2:      e -0.3924529     5\n\n\nExample:\n\n(small_dtb[c(2, 5)])\n\n        x          y     z\n   &lt;char&gt;      &lt;num&gt; &lt;int&gt;\n1:      b  0.4520126     2\n2:      e -0.3924529     5\n\n\nup to – Sort flights first by column origin in ascending order, and then by dest in descending order:",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction to data.table",
    "section": "",
    "text": "1.1 Basics\nlibrary(data.table)\n\nset.seed(12345)\n\nsmall_dtb &lt;- data.table(x = letters[1:5],\n                        y = rnorm(5),\n                        z = 1:5)\nsmall_dtb\n\n        x          y     z\n   &lt;char&gt;      &lt;num&gt; &lt;int&gt;\n1:      a  0.5855288     1\n2:      b  0.7094660     2\n3:      c -0.1093033     3\n4:      d -0.4534972     4\n5:      e  0.6058875     5\nExample:\n(small_dtb[x %in% c('a', 'b', 'c', 'e') & z &gt;= 3])\n\n        x          y     z\n   &lt;char&gt;      &lt;num&gt; &lt;int&gt;\n1:      c -0.1093033     3\n2:      e  0.6058875     5\nExample:\n(small_dtb[c(2, 5)])\n\n        x         y     z\n   &lt;char&gt;     &lt;num&gt; &lt;int&gt;\n1:      b 0.7094660     2\n2:      e 0.6058875     5\nExample:\n# x in in descending order; and then y in ascending order\n(small_dtb[order(-x, y)])\n\n        x          y     z\n   &lt;char&gt;      &lt;num&gt; &lt;int&gt;\n1:      e  0.6058875     5\n2:      d -0.4534972     4\n3:      c -0.1093033     3\n4:      b  0.7094660     2\n5:      a  0.5855288     1\nExample:\n(small_dtb[, .(x, z)])\n\n        x     z\n   &lt;char&gt; &lt;int&gt;\n1:      a     1\n2:      b     2\n3:      c     3\n4:      d     4\n5:      e     5\nExample:\n# select and rename\n(small_dtb[, .(x_1 = x, z)])\n\n      x_1     z\n   &lt;char&gt; &lt;int&gt;\n1:      a     1\n2:      b     2\n3:      c     3\n4:      d     4\n5:      e     5\nExample:\n# return a vector\n(small_dtb[, z])\n\n[1] 1 2 3 4 5\nExample:\n(small_dtb)\n\n        x          y     z\n   &lt;char&gt;      &lt;num&gt; &lt;int&gt;\n1:      a  0.5855288     1\n2:      b  0.7094660     2\n3:      c -0.1093033     3\n4:      d -0.4534972     4\n5:      e  0.6058875     5\n\n(chk &lt;- small_dtb[, sum(y + z &gt; 3)])\n\n[1] 2\nExample:\n(small_dtb[x %in% letters[2:4], sum(y + z &gt; 3)])\n\n[1] 1\nExample:\n(small_dtb[x %in% letters[2:4], .(mean_1 = mean(y), mean_2 = mean(z))])\n\n       mean_1 mean_2\n        &lt;num&gt;  &lt;num&gt;\n1: 0.04888851      3\nExample:\n(small_dtb[x %in% c('a', 'c', 'f') & y &gt; 0, .N])\n\n[1] 1\nExample:\nsel_vars &lt;- c('x', 'z')\n(small_dtb[, sel_vars, with = FALSE])\n\n        x     z\n   &lt;char&gt; &lt;int&gt;\n1:      a     1\n2:      b     2\n3:      c     3\n4:      d     4\n5:      e     5\nExample:\n(small_dtb[, -c('x', 'z')])\n\n            y\n        &lt;num&gt;\n1:  0.5855288\n2:  0.7094660\n3: -0.1093033\n4: -0.4534972\n5:  0.6058875\n\n(small_dtb[, !c('x', 'z')])\n\n            y\n        &lt;num&gt;\n1:  0.5855288\n2:  0.7094660\n3: -0.1093033\n4: -0.4534972\n5:  0.6058875\nExample:\n(small_dtb[, y:z])\n\n            y     z\n        &lt;num&gt; &lt;int&gt;\n1:  0.5855288     1\n2:  0.7094660     2\n3: -0.1093033     3\n4: -0.4534972     4\n5:  0.6058875     5",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction to data.table</span>"
    ]
  },
  {
    "objectID": "intro.html#basics",
    "href": "intro.html#basics",
    "title": "1  Introduction to data.table",
    "section": "",
    "text": "data.table()\n\n\n\nYou can also convert existing objects to a data.table using setDT() (for data.frame and list structures) or as.data.table() (for other structures).\n\n\nGeneral form DT[i, j, by] — Take DT, subset/reorder rows using i, then calculate j, grouped by by.\nSubset rows in i\n\n\n\n\n\n\nOrder rows\n\n\n\n\nSelect column(s) in j\n\n\n\n\nTip: As long as j-expression returns a list, each element of the list will be converted to a column in the resulting data.table.\n\n\n\n\n\n\nCompute or do in j\n\n\n\n\nSubset in i and do in j\n\n\n\n\n\n\nSpecial symbol .N\n\n\n.N is a special built-in variable that holds the number of observations in the current group.\n\n\n\n\nSelect columns named in a variable using with = FALSE\n\n\n\n\nDeselect columns using - or !\n\n\n\n\nSelect by specifying start and end column names (From version 1.9.5+)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction to data.table</span>"
    ]
  },
  {
    "objectID": "intro.html#aggregations",
    "href": "intro.html#aggregations",
    "title": "1  Introduction to data.table",
    "section": "1.2 Aggregations",
    "text": "1.2 Aggregations\n\n# create a data.table \nset.seed(98765)\n\ndt &lt;- data.table(ID = sprintf(\"%03d\", 1L:100L))\ndt[, `:=`(x = sample(letters[1:3],   length(ID), replace = TRUE),\n          y = sample(month.abb, length(ID), replace = TRUE),\n          w = runif(length(ID)),\n          z = rnorm(length(ID))\n         )]\n\nExample:\n\n(dt[, .(.N), by = y][order(match(y, month.abb))]) # nice!\n\n         y     N\n    &lt;char&gt; &lt;int&gt;\n 1:    Jan     9\n 2:    Feb     6\n 3:    Mar    10\n 4:    Apr     8\n 5:    May     8\n 6:    Jun     6\n 7:    Jul     9\n 8:    Aug     8\n 9:    Sep    13\n10:    Oct     5\n11:    Nov    10\n12:    Dec     8\n\n# or (useful for coding programmatically)\n(dt[, .(.N), by = \"y\"][order(match(y, month.abb))]) \n\n         y     N\n    &lt;char&gt; &lt;int&gt;\n 1:    Jan     9\n 2:    Feb     6\n 3:    Mar    10\n 4:    Apr     8\n 5:    May     8\n 6:    Jun     6\n 7:    Jul     9\n 8:    Aug     8\n 9:    Sep    13\n10:    Oct     5\n11:    Nov    10\n12:    Dec     8\n\n\nExample:\n\n(dt[, .(.N), by = .(y, x)][order(match(y, month.abb), x)])\n\n         y      x     N\n    &lt;char&gt; &lt;char&gt; &lt;int&gt;\n 1:    Jan      a     2\n 2:    Jan      b     3\n 3:    Jan      c     4\n 4:    Feb      a     2\n 5:    Feb      b     1\n 6:    Feb      c     3\n 7:    Mar      a     2\n 8:    Mar      b     5\n 9:    Mar      c     3\n10:    Apr      a     4\n11:    Apr      b     1\n12:    Apr      c     3\n13:    May      a     2\n14:    May      b     5\n15:    May      c     1\n16:    Jun      a     2\n17:    Jun      b     4\n18:    Jul      a     2\n19:    Jul      b     4\n20:    Jul      c     3\n21:    Aug      a     4\n22:    Aug      b     3\n23:    Aug      c     1\n24:    Sep      a     2\n25:    Sep      b     4\n26:    Sep      c     7\n27:    Oct      a     3\n28:    Oct      b     2\n29:    Nov      a     4\n30:    Nov      b     2\n31:    Nov      c     4\n32:    Dec      a     2\n33:    Dec      b     3\n34:    Dec      c     3\n         y      x     N\n\n\n\nMultiple columns in j — .SD (Subset of Data)\n\n\n.SD contains all the columns except the grouping columns by default.\n\nExample:\n\n(dt[, lapply(.SD, dplyr::n_distinct), by = y][\n  order(match(y, month.abb))\n])\n\n         y    ID     x     w     z\n    &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;\n 1:    Jan     9     3     9     9\n 2:    Feb     6     3     6     6\n 3:    Mar    10     3    10    10\n 4:    Apr     8     3     8     8\n 5:    May     8     3     8     8\n 6:    Jun     6     2     6     6\n 7:    Jul     9     3     9     9\n 8:    Aug     8     3     8     8\n 9:    Sep    13     3    13    13\n10:    Oct     5     2     5     5\n11:    Nov    10     3    10    10\n12:    Dec     8     3     8     8\n\n\n\nSpecify just the columns — .SDcols\n\nExample:\n\n(dt[, lapply(.SD, mean), by = y, .SDcols = c(\"w\", \"z\")][\n  order(match(y, month.abb))])\n\n         y         w           z\n    &lt;char&gt;     &lt;num&gt;       &lt;num&gt;\n 1:    Jan 0.5971593  0.28410248\n 2:    Feb 0.5989121 -0.67326526\n 3:    Mar 0.4746379 -0.12092181\n 4:    Apr 0.5588728 -0.13687424\n 5:    May 0.6600847  0.46348110\n 6:    Jun 0.4236736 -0.50359112\n 7:    Jul 0.4167678  0.25590180\n 8:    Aug 0.3144608 -0.07113313\n 9:    Sep 0.5571863 -0.39837109\n10:    Oct 0.4690520 -0.31808535\n11:    Nov 0.3810588  0.13124172\n12:    Dec 0.3255893  0.45452864\n\n\n\nSubset .SD for each group\n\nExample:\n\n(dt[, head(.SD, 2), by = y][\n  order(match(y, month.abb))]\n)\n\n         y     ID      x          w           z\n    &lt;char&gt; &lt;char&gt; &lt;char&gt;      &lt;num&gt;       &lt;num&gt;\n 1:    Jan    013      b 0.36384835  0.25820390\n 2:    Jan    032      c 0.41055509  1.58401597\n 3:    Feb    001      c 0.86811462 -2.28932905\n 4:    Feb    022      c 0.54402505 -1.03936619\n 5:    Mar    002      a 0.73088424  0.49876437\n 6:    Mar    006      b 0.66991774  0.28428795\n 7:    Apr    008      c 0.30558214 -1.29345693\n 8:    Apr    015      b 0.61864358  1.53498830\n 9:    May    017      b 0.98673557  0.14859075\n10:    May    028      b 0.82192736  0.39779991\n11:    Jun    026      a 0.63850907 -0.89876505\n12:    Jun    031      b 0.60116673  0.04881219\n13:    Jul    009      c 0.51579622  1.14680667\n14:    Jul    019      a 0.73327795  1.65312728\n15:    Aug    010      c 0.35723023  1.13575657\n16:    Aug    029      a 0.05977576 -0.09744826\n17:    Sep    003      c 0.99907046 -1.80143219\n18:    Sep    014      a 0.25378696 -0.34646956\n19:    Oct    018      a 0.66016728 -0.30006219\n20:    Oct    025      a 0.08602937  0.11936690\n21:    Nov    005      a 0.85700207 -1.31407637\n22:    Nov    021      b 0.39336712  0.60190574\n23:    Dec    004      b 0.09781495  2.03149960\n24:    Dec    011      c 0.10491620 -0.42566702\n         y     ID      x          w           z\n\n\n\nMake ‘longer’ table — melt\n\n\nfk_data &lt;- data.table(week = 1:5,\n                      player_1 = rnorm(5),\n                      player_2 = rnorm(5))\nlong_tb &lt;- melt(fk_data,\n                measure.vars = c(\"player_1\", \"player_2\"),\n                variable.name = \"player\",\n                value.name = \"value\")\n(long_tb)\n\n     week   player      value\n    &lt;int&gt;   &lt;fctr&gt;      &lt;num&gt;\n 1:     1 player_1  0.9842654\n 2:     2 player_1  0.1542017\n 3:     3 player_1 -0.7450324\n 4:     4 player_1 -0.2477755\n 5:     5 player_1  0.4545554\n 6:     1 player_2 -0.3609907\n 7:     2 player_2  0.4675788\n 8:     3 player_2  1.4384395\n 9:     4 player_2 -0.1420841\n10:     5 player_2 -1.4523287\n\n\n\nMake ‘wider’ table — dcast\n\n\n# add row id\n# long_tb[, id := sample(1:5), by = player][, id := paste0('wk_', id)]\n\nwide_tb &lt;- dcast(\n  long_tb,\n  week ~ player,\n  value.var = \"value\"\n)\n(wide_tb)\n\nKey: &lt;week&gt;\n    week   player_1   player_2\n   &lt;int&gt;      &lt;num&gt;      &lt;num&gt;\n1:     1  0.9842654 -0.3609907\n2:     2  0.1542017  0.4675788\n3:     3 -0.7450324  1.4384395\n4:     4 -0.2477755 -0.1420841\n5:     5  0.4545554 -1.4523287",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction to data.table</span>"
    ]
  }
]